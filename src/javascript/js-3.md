---
title: 第三戦 性能の戦い
icon: rocket
navbar: false
sidebar: false
editLink: false
lastUpdated: false
pageInfo: false
toc: false
comment: false
prev: /javascript/js-2
next: /javascript/js-4
order: 3
---

<div style="display:flex;">
<div style="flex:1;">

激しい市場競争とユーザー争奪戦の中で、  
ブラウザメーカー各社は、自社ブラウザへの新機能の追加に  
全力を注いでいます。  

しかし、当時のJavaScriptエンジンはシンプルで、JavaScriptの処理効率が低い。  
Webアプリケーション日々複雑化により、ブラウザの動きも重くなりました。  

**性能問題は、当時すべてのブラウザメーカーが直面せざるを得ない深刻な課題となっていました。**   

</div>
<div>

![Alt](/assets/image/js-3/update.jpg " " =200x)

![Alt](/assets/image/js-3/Update-1.jpg " " =200x)
</div>
</div>

![Alt](/assets/image/js-3/cpu.png " " =100%x)

## JavaScriptエンジン Google V8（ヴィエイト）の誕生
<div style="display:flex;">
<div style="flex:1;">
 
2008年、Google開発したオープンソースのJavaScriptエンジンV8（ヴィエイト）が発表されました。  
V8エンジンはC++で開発され、JavaScriptを直接マシンコードにコンパイルすることで、実行速度を大幅に向上させました。  

</div>
<div>

![Alt](/assets/image/js-3/chrome-v8.png "chrome-v8" =200x)
</div>
</div>

::: tip Google V8 とV型8気筒エンジン

<div style="display:flex;">
<div style="flex:1;">

この名称は、当時パフォーマンス最高峰のV型8気筒エンジン（略称「V8」）に由来しています。  

一方、『V8 JavaScriptエンジン』も、JavaScriptエンジンとして優れた性能を発揮することを目的に命名されました。
</div>
<div>

![Alt](/assets/image/nodejs/v8.jpg "V型8気筒エンジン" =200x)
</div>
</div>
:::

### JavaScriptの実行速度の飛躍（ひやく）的な向上  
<div style="display:flex;">
<div style="flex:1;">

V8は従来のJavaScriptエンジンより**圧倒的に速い実行速度**を提供しました。これにより、ウェブアプリのパフォーマンスも大幅に向上し、  
昔は**性能の問題で開発が放置されていたアイデア**や、**大規模なアプリケーションの構築**が可能になりました。
</div>
<div>

![Alt](/assets/image/js-3/pafomasu.png " " =200x)
</div>
</div>

## 性能向上によってWeb開発の変革が引き起こされた

### 変革1: Node.jsの誕生によりサーバー側でもJavaScriptで開発可能

当時、JavaScript は主にクライアントサイドで使用されており、開発者はフロントエンドとバックエンドで異なる言語を使用する必要がありました。  
Node.js はサーバーサイドのコードを JavaScript で記述できるようにすることで、  
**フロントエンドとバックエンドの開発言語を統一させました。**  
**開発プロセスが簡素化され、学習コストも大幅に低減しました。**

::: tip 軽量で高性能なサーバー
Node.js の設計理念の一つは「軽量で高速な動作」であり、これは Google V8 エンジンの高いパフォーマンスと非常に相性が良いです。  
V8エンジンの高性能により、Node.js はServer Application（サーバーアプリケーション）を構築するための理想的な選択肢となっています。
:::

![Alt](/assets/image/js-3/nodejsusefor.png " " =100%x)
---

### 変革2: シングルページアプリケーション（SPA）の普及（ふきゅう）

- **従来のマルチページアプリケーション（MPA）の制限**  

従来のMPAでは、ユーザーがページと対話するたびにサーバーへのリクエストを送信し、ページ全体を再読み込みする必要がありました。  
この方法はシンプルですが、毎回ページを再読み込みするため、ロード時間が長く、ユーザー体験が低下します。  
特に頻繁にページ遷移が必要なアプリケーションでは非効率です。


![Alt](/assets/image/js-3/MPAマルチアプリケーションの仕組み.jpg "MPAマルチアプリケーションの仕組み" =100%x)


- **SPA（シングルページアプリケーション）とは**   
<div style="display:flex;">
<div style="flex:1;">

「SPA」とは「Single Page Application」の略で、  
１つのページで、スムーズにコンテンツ切り替えができる技術のことです。  
従来のページの読み込みでは、複数のページがあり、それを１ページづつアクセスし表示していく方法でした。  
SPAでは、一度のアクセスでWebページの全体を取得した後、差分データのみを表示させることで、ページの高速化が期待できます。
</div>
<div>

![Alt](/assets/image/js-3/spa-2.png " " =200x)
</div>
</div>


- **SPAとMPAの区別**  

SPAとMPAの区別は「ページ取得のサーバーへのアクセス回数」です。  
SPAでは、一度サーバーにアクセスしたタイミングでWebページの全体を取得します。  
その後のページ切り替えは、差分データの情報のみを取得します。

![Alt](/assets/image/js-3/MPAの説明画像.png " " =50%x)
![Alt](/assets/image/js-3/SPAの説明画像.png " " =50%x)

一方、MPAの場合はページにアクセスする度、サーバーから一回ずつページを取得します。  
上記の区別を表にすると、以下のようになります。

|	|ページの取得数（1回）	|サーバーへのアクセス回数（ページ単位）	|取得データ（ページ単位）	|
|:-:|:-:					|:-:									|:-:						|
|SPA|Webページ全体			|1回									|差分データのみ				|
|MPA|1ページ				|ページごとにサーバーへアクセス			|1ページ分のデータ			|

## SPAにおけるメリット・デメリット
### SPAのメリット
- **パフォーマンスの向上**  
SPAは１ページのデータを全て取得せず、差分データのみ取得します。  
これによりデータの通信量に抑えられ、同時にパフォーマンスも向上します。  

- **UX（ユーザー体験）の向上**  
SPAの特徴を活かすことで、UX（ユーザー体験）の向上にもつながります。  
実際のサービスを例に交え（まじえ）て説明していきましょう。

例えばLDMが提供している「最新号記事」というサービス。  

<div style="display:flex;">
<div>

![Alt](/assets/image/js-3/logo-jmam-hrm-club.png " " =100x)  
![Alt](/assets/image/js-3/ldm.png " " =200x)  
</div>
<div style="flex:1;margin-left:10px;">

このサービスでは現在の記事画面から、他の記事を見ようとした場合、  
ページ遷移をすることなく、別の記事の情報を見ることができます。  
これはSPAの「１つのページで、スムーズにコンテンツ切り替えができる」特徴をに活かしている例です。
</div>
</div>

---

### SPAのデメリット
ここまでメリットについて説明してきましたが、逆にデメリットはなにがあるのでしょうか？

<div style="display:flex;">
<div style="flex:1;">

- **初期ページを読み込むのに時間がかかる**  
特徴の１つとして、1回の通信でWebページ全体を取得します。   
この特徴が、初期ページの読み込みに時間をかけてしまう原因になります。  

</div>
<div>

![Alt](/assets/image/js-3/天平.png " " =160x)
</div>
</div>
<div style="display:flex;">
<div style="flex:1;">

- **開発コストがかかる**  
SPAは従来の方法と比べ、開発にかかるコストがどうしても高くなってしまうのが現状です。  
またSPAを使う上で、代表的な技術の「React」や「Vue」というものがあります。  
こういった流行の技術を扱える人材は増えてきましたが、高品質なWebアプリの開発が可能な人材はまだまだ少ない印象のため。リソース面での開発コストもかかります。  

</div>
<div>

![Alt](/assets/image/js-3/cost.png " " =160x)
</div>
</div>

- **SEO対策が必要**  
SPA（シングルページアプリケーション）はページの再読み込み回数を減らし、より速いユーザー体験を提供するため、デフォルトで**CSR**を採用しております。
::: tip CSR（Client Side Rendering）（クライアントサイドレンダリング）
簡単に言うと、CSRとは、Client側（ブラウザ）で画面を組み立てることです。  
初回アクセス時はHTMLファイルの中身はほぼ空なので何も表示されず、  
CSSとDBのデータが画面構築の材料になり、
JavaScriptは画面を組み立てるための説明書のようなものです。  

![Alt](/assets/image/js-3/csr.png "CSR　画面初期表示までの流れ" =100%x)
::: 
::: tip SSR（Server Side Rendering）
SSRとは、ブラウザではなく、サーバ側でレンダリングして、クライアントサイドで描画（ペインティング）する手法です。  
簡単に言うと、サーバ側は右sでに組み立て済のHTMLをブラウザ側に返すことです。  

![Alt](/assets/image/js-3/ssr.png "SSR　画面初期表示までの流れ" =100%x)
::: 

::: details ❗️ここまで説明してきましたが、CSRがSEOと相性が悪い原因は何ですか？
<div style="display:flex;">
<div style="flex:1;">

初回アクセス時にサーバーから返されるHTMLは、ほぼ空のファイルです。  
多くのクローラーはブラウザのような画面を組み立てる能力を持っていないため、ページの内容を正しく認識できない場合があります。
</div>
<div>

![Alt](/assets/image/js-3/robot.png " " =160x)
</div>
</div>

:::
## SPA・MPAそれぞれを採用するケースは?
ここまでSPAについて説明してきましたが、「結局SPAはどういったケースに向いているんだろう？」と思う方もいらっしゃるかと思います。  

そこで最後にSPAとMPA（従来の方法）を比較し、具体的にどういったケースで採用した方がいいのかをまとめたいと思います。  

![Alt](/assets/image/js-3/SPAvsMPA.jpg " " =100%x)

---
### SPAを採用すべきケース
SPAはユーザーの操作が多く、かつ長く利用するケースがSPAに向いている。  
具体的な例をあげると、以下のようなケースがSPAでは有効的かと思います。  
- タスク管理（代表例：Backlog）  
- メッセージ（代表例：Slack）  
- SNS（代表例：Facebook）  

---
### MPAを採用すべきケース
MPAは開発コストも抑え、ユーザーの滞在時間が長くないケースがMPAに向いている。  
具体的な例をあげると、以下のようなケースがMPAでは有効的かと思います。  
- コンテンツ重視のウェブサイト（代表例：JMAM　HRM人材育成ホームページ）
- 企業サイト（代表例：ストラのホームページ）
- 政府や教育機関のウェブサイト（代表例：厚生劳动省ホームページ）
- その他　開発コストを抑えたいプロジェクトなど 

::: important 戦果

### Google V8エンジンの登場に伴って、JavaScriptの実行効率が質的に飛躍を実現しました。
### 一方、性能問題が解決された以上、Node.jsやSPAなど様々のアイデアが誕生し、JavaScriptに新たな世界の扉が開かれました。

:::